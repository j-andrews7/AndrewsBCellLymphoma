<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyzing RNA-seq data • OneLinerOmics</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyzing RNA-seq data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OneLinerOmics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ChIPseqAnalysis.html">Analyzing ChIP-seq data</a>
    </li>
    <li>
      <a href="../articles/RNAseqAnalysis.html">Analyzing RNA-seq data</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/j-andrews7/OneLinerOmics">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyzing RNA-seq data</h1>
                        <h4 class="author">Jared Andrews</h4>
            <address class="author_afil">
      Washington University School of Medicine, Department of Laboratory and Genomic Medicine<br><a class="author_email" href="mailto:#"></a><a href="mailto:jared.andrews07@gmail.com" class="email">jared.andrews07@gmail.com</a>
      </address>
                  
            <h4 class="date">Revised: December 12th, 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/j-andrews7/OneLinerOmics/blob/master/vignettes/RNAseqAnalysis.Rmd"><code>vignettes/RNAseqAnalysis.Rmd</code></a></small>
      <div class="hidden name"><code>RNAseqAnalysis.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette walks through analysis of the B cell lymphoma RNA-seq data included in the future Andrews et al. (2019, your favorite journal with an impact factor &gt; 30) paper. It uses the convenience functions included in this <a href="https://github.com/j-andrews7/AndrewsBCellLymphoma">package</a> to streamline the process.</p>
<p>Several command line tools as well as python are also utilized - each code block should indicate whether it is <code>bash</code>, <code>R</code>, or <code>python</code> code. If your system is set up properly, you can still <a href="https://bookdown.org/yihui/rmarkdown/language-engines.html">run these code chunks in Rmarkdown files within RStudio</a>, assuming you have all of the software installed.</p>
<p>Required Software:</p>
<ul>
<li>R (3.6+)</li>
<li>python</li>
<li><a href="https://combine-lab.github.io/salmon/">salmon (v0.14+)</a></li>
<li>
<a href="https://bedtools.readthedocs.io/en/latest/">bedtools</a> - only needed if generating salmon decoy transcriptome</li>
<li>
<a href="https://github.com/marbl/MashMap">mashmap</a> - only needed if generating salmon decoy transcriptome</li>
</ul>
</div>
<div id="suggested-reading" class="section level1">
<h1 class="hasAnchor">
<a href="#suggested-reading" class="anchor"></a>Suggested Reading</h1>
<p>That is, if you ask me a question and haven’t read these first, I’m going to tell you to read them.</p>
<ul>
<li>The <a href="https://bioconductor.org/packages/release/bioc/vignettes/DESeq2/inst/doc/DESeq2.html#standard-workflow">DESeq2 vignette</a>.</li>
<li>The <a href="http://master.bioconductor.org/packages/release/workflows/vignettes/rnaseqGene/inst/doc/rnaseqGene.html">rnaseqGene</a> workflow, which walks through a DESeq2 analysis in great detail.</li>
</ul>
<div id="generating-gene-counts" class="section level2">
<h2 class="hasAnchor">
<a href="#generating-gene-counts" class="anchor"></a>Generating gene counts</h2>
<p>Going the <code>salmon</code> -&gt; <code>DESeq2</code> route. This requires R, salmon v0.14, and DESeq2 (along with a few other packages). Using hg19, cause forget re-aligning all the ChIP-seq and making new tracks. <code>salmon</code> needs <code>mashmap</code> and <code>bedtools</code> as well if generating “decoy-aware” transcriptomes. The Google can show you how to install those.</p>
<div id="create-decoy-reference-transcriptome" class="section level3">
<h3 class="hasAnchor">
<a href="#create-decoy-reference-transcriptome" class="anchor"></a>Create decoy reference transcriptome</h3>
<p>Newer versions of salmon recommend using a <em>decoy-aware</em> transcriptome to generate the index file to be used for selective alignment. This process is a bit annoying, so the authors have pre-computed some <a href="https://drive.google.com/drive/folders/14VqSdZAKH82QwDWhMXNLFqMoskoqv3fS">decoy transcriptomes</a> for hg19 and hg38 with different annotations. In this case, I used the <a href="ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_31/GRCh37_mapping/">GENCODE v31 annotations</a> that had been lifted over to hg19, so I had to generate them myself.</p>
<blockquote>
<p><strong>This had to be run on a cluster with 128 GB RAM. If you can avoid this step by using their pre-generated decoys, I recommend doing so.</strong></p>
</blockquote>
<p>My data is already in folders and all, so some of the paths are kinda inefficient, but I really don’t care. This is needed to create the index for <code>salmon</code>. Using GENCODE v31 annotations/sequences that have been mapped back to GRCh37 (hg19).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># bash</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="fu">mkdir</span> -p RNA_seq/ref</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># annotations</span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="fu">wget</span> ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_31/GRCh37_mapping/gencode.v31lift37.annotation.gtf.gz</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="fu">mv</span> gencode.v31lift37.annotation.gtf.gz ./RNA_Seq/ref/gencode.v31lift37.annotation.gtf.gz</a>
<a class="sourceLine" id="cb1-7" title="7"><span class="fu">gunzip</span> ./RNA_seq/ref/gencode.v31lift37.annotation.gtf.gz</a>
<a class="sourceLine" id="cb1-8" title="8"></a>
<a class="sourceLine" id="cb1-9" title="9"><span class="co"># transcriptome</span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="fu">wget</span> ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_31/GRCh37_mapping/gencode.v31lift37.transcripts.fa.gz</a>
<a class="sourceLine" id="cb1-11" title="11"><span class="fu">mv</span> gencode.v31lift37.transcripts.fa.gz ./RNA_Seq/ref/gencode.v31lift37.transcripts.fa.gz</a>
<a class="sourceLine" id="cb1-12" title="12"><span class="fu">gunzip</span> ./RNA_seq/ref/gencode.v31lift37.transcripts.fa.gz</a>
<a class="sourceLine" id="cb1-13" title="13"></a>
<a class="sourceLine" id="cb1-14" title="14"><span class="co"># genome</span></a>
<a class="sourceLine" id="cb1-15" title="15"><span class="fu">wget</span> ftp://ftp.ebi.ac.uk/pub/databases/gencode/Gencode_human/release_31/GRCh37_mapping/GRCh37.primary_assembly.genome.fa.gz</a>
<a class="sourceLine" id="cb1-16" title="16"><span class="fu">mv</span> GRCh37.primary_assembly.genome.fa.gz ./RNA_Seq/ref/GRCh37.primary_assembly.genome.fa.gz</a>
<a class="sourceLine" id="cb1-17" title="17"><span class="fu">gunzip</span> ./RNA_seq/ref/GRCh37.primary_assembly.genome.fa.gz</a></code></pre></div>
<p>Download the script to generate the decoys.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb2-1" title="1"><span class="co"># bash</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># Script for generating decoy genome.</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="fu">wget</span> https://raw.githubusercontent.com/COMBINE-lab/SalmonTools/master/scripts/generateDecoyTranscriptome.sh</a></code></pre></div>
<p>This script crashed a lot for me, so I ended up editing it to just snag the last 10 commands or so (those with the step comments) and removing the variable parsing at the beginning, as it uses some deprecated linux commands (<code>readpath</code>) that I couldn’t install on our computing cluster.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1"><span class="co"># bash</span></a>
<a class="sourceLine" id="cb3-2" title="2"><span class="fu">bash</span> generateDecoyTranscriptome.sh -j 2 -a ./RNA_Seq/ref/gencode.v31lift37.annotation.gtf -g ./RNA_Seq/ref/GRCh37.primary_assembly.genome.fa -t ./RNA_Seq/ref/gencode.v31lift37.transcripts.fa -o ./RNA_Seq/ref/decoys/</a></code></pre></div>
</div>
<div id="index-the-transcriptome" class="section level3">
<h3 class="hasAnchor">
<a href="#index-the-transcriptome" class="anchor"></a>Index the transcriptome</h3>
<p>This will generate the <em>decoy-aware</em> transcriptome index for our annotations.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb4-1" title="1"><span class="co"># Bash</span></a>
<a class="sourceLine" id="cb4-2" title="2"><span class="co"># Now actually create the index for salmon. We lower k as some of our samples use 50 bp reads.</span></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="ex">salmon</span> index -t ./RNA_Seq/ref/decoys/gentrome.fa -i ./RNA_Seq/ref/gencodev31_grch37_index --decoys ./RNA_Seq/ref/decoys/decoys.txt -k 25 --gencode</a></code></pre></div>
</div>
<div id="quantify" class="section level3">
<h3 class="hasAnchor">
<a href="#quantify" class="anchor"></a>Quantify</h3>
<p>Actually generate the gene counts now.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1"><span class="co"># bash</span></a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/Control.html">for</a></span> <span class="ex">f</span> in ./RNA_Seq/FASTQs/*<span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb5-3" title="3">    <span class="va">samp=</span><span class="st">"</span><span class="va">${f##</span>*/<span class="va">}</span><span class="st">"</span></a>
<a class="sourceLine" id="cb5-4" title="4">    <span class="va">count=$(</span><span class="fu">ls</span> -1 <span class="st">"</span><span class="va">$f</span><span class="st">"</span> <span class="kw"><a href="https://rdrr.io/r/base/Logic.html">|</a></span> <span class="fu">wc</span> -l<span class="va">)</span></a>
<a class="sourceLine" id="cb5-5" title="5">    <span class="bu">echo</span> <span class="st">"</span><span class="va">$count</span><span class="st">"</span></a>
<a class="sourceLine" id="cb5-6" title="6">    <span class="kw"><a href="https://rdrr.io/r/base/Control.html">if</a></span><span class="bu"> [</span> <span class="va">$count</span> <span class="ot">-gt</span> 1<span class="bu"> ]</span></a>
<a class="sourceLine" id="cb5-7" title="7">    <span class="kw">then</span></a>
<a class="sourceLine" id="cb5-8" title="8">        <span class="ex">salmon</span> quant --validateMappings --threads 2 --seqBias -l A -1 <span class="st">"</span><span class="va">$f</span><span class="st">"</span>/<span class="st">"</span><span class="va">$samp</span><span class="st">"</span>_1.fq.gz -2 <span class="st">"</span><span class="va">$f</span><span class="st">"</span>/<span class="st">"</span><span class="va">$samp</span><span class="st">"</span>_2.fq.gz -o ./RNA_Seq/quants/<span class="st">"</span><span class="va">$samp</span><span class="st">"</span> --index ./RNA_Seq/ref/gencodev31_grch37_index</a>
<a class="sourceLine" id="cb5-9" title="9">    <span class="kw"><a href="https://rdrr.io/r/base/Control.html">else</a></span></a>
<a class="sourceLine" id="cb5-10" title="10">        <span class="ex">salmon</span> quant --validateMappings --threads 2 --seqBias -l A -r <span class="st">"</span><span class="va">$f</span><span class="st">"</span>/<span class="st">"</span><span class="va">$samp</span><span class="st">"</span>.RNA.fq.gz -o ./RNA_Seq/quants/<span class="st">"</span><span class="va">$samp</span><span class="st">"</span> --index ./RNA_Seq/ref/gencodev31_grch37_index</a>
<a class="sourceLine" id="cb5-11" title="11">    <span class="kw">fi</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="kw">done</span></a></code></pre></div>
</div>
<div id="make-transcript-to-gene-mappings" class="section level3">
<h3 class="hasAnchor">
<a href="#make-transcript-to-gene-mappings" class="anchor"></a>Make Transcript-to-Gene Mappings</h3>
<p>For gene-level summarization and readability.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><a class="sourceLine" id="cb6-1" title="1"><span class="co"># python</span></a>
<a class="sourceLine" id="cb6-2" title="2">outter <span class="op">=</span> <span class="bu">open</span>(<span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>, <span class="st">"w"</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="cf">with</span> <span class="bu">open</span>(<span class="st">"./RNA_Seq/ref/gencode.v31lift37.transcripts.fa"</span>) <span class="im">as</span> f:</a>
<a class="sourceLine" id="cb6-4" title="4">    <span class="cf">for</span> line <span class="kw"><a href="https://rdrr.io/r/base/Control.html">in</a></span> f:</a>
<a class="sourceLine" id="cb6-5" title="5">        <span class="cf">if</span> <span class="kw">not</span> line.startswith(<span class="st">"&gt;"</span>):</a>
<a class="sourceLine" id="cb6-6" title="6">            <span class="cf">continue</span></a>
<a class="sourceLine" id="cb6-7" title="7">        line <span class="op">=</span> line.strip().strip(<span class="st">"&gt;"</span>).split(<span class="st">"|"</span>)</a>
<a class="sourceLine" id="cb6-8" title="8">        tx <span class="op">=</span> line[<span class="dv">0</span>]</a>
<a class="sourceLine" id="cb6-9" title="9">        symb <span class="op">=</span> line[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb6-10" title="10">        out <span class="op">=</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>.join([tx, symb])</a>
<a class="sourceLine" id="cb6-11" title="11">        <span class="bu">print</span>(out, <span class="bu">file</span> <span class="op">=</span> outter)</a>
<a class="sourceLine" id="cb6-12" title="12"></a>
<a class="sourceLine" id="cb6-13" title="13">outter.close()</a></code></pre></div>
</div>
<div id="check-mapping-rates" class="section level3">
<h3 class="hasAnchor">
<a href="#check-mapping-rates" class="anchor"></a>Check Mapping Rates</h3>
<p>An easy diagnostic to ensure everything worked properly is just to check the mapping rates for each sample. Depending on the experimental setup and annotations, a mapping rate of 50-90% may be expected. Really low rates (&lt;40% or so) are worrying, and such samples should be removed from the analysis if possible.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/Control.html">for</a></span> <span class="ex">f</span> in ./RNA_Seq/quants/*<span class="kw">;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-2" title="2">  <span class="bu">echo</span> <span class="st">"</span><span class="va">${f##</span>*/<span class="va">}</span><span class="st">"</span><span class="kw">;</span></a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="fu">grep</span> <span class="st">"Mapping Rate"</span> <span class="st">"</span><span class="va">$f</span><span class="st">"</span>/logs/salmon_quant.log<span class="kw">;</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">done</span></a></code></pre></div>
</div>
</div>
<div id="analysis-with-r" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-with-r" class="anchor"></a>Analysis with R</h2>
<p>Install this package if you haven’t already with <code><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">devtools::install_github("j-andrews7/AndrewsBCellLymphoma")</a></code>. If you don’t have <code>devtools</code>, it can be installed with <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("devtools")</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># R</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(OneLinerOmics))</a></code></pre></div>
<p>The only thing you need now is a sample sheet, which is just a table with sample names and metadata columns. We can take a peek at the sample sheet I’m using so he can see how they’re constructed. It can include as many metadata columns as you’d like.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># R</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="co"># Basic sample sheet.</span></a>
<a class="sourceLine" id="cb9-3" title="3">samples &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span>(<span class="st">"./RNA_Seq/Samples.pairedCLL.txt"</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(samples, <span class="dv">10</span>)</a></code></pre></div>
<div id="run-deseq2" class="section level3">
<h3 class="hasAnchor">
<a href="#run-deseq2" class="anchor"></a>Run DESeq2</h3>
<p>DESeq2 is a very popular R package for performing differential expression analysis. Raw RNA-seq counts follow a negative binomial distribution, which is how DESeq2 models the data. It is quick, flexible, and generally works quite well with little to no parameter tweaking. It can also help to mitigate the technical or batch effects on the analysis, a feature which we’ll take advantage of here.</p>
<p>Most of these samples are 150 bp, paired-end sequencing (as shown in the ‘lib’ column of the sample sheet). A handful are 50 bp, single-end sequencing, which introduces a significant confounding factor to the analysis. In our model design, we’ll specify that we want to ignore effects due to this technical difference (by setting <code>block = "lib"</code>). The model isn’t magic, so we may very well still see evidence of the library-prep differences regardless, as they are quite strong.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># R</span></a>
<a class="sourceLine" id="cb10-2" title="2">can.v.norm.paired &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RunDESeq2.html">RunDESeq2</a></span>(<span class="dt">outpath =</span> <span class="st">"./RNA_Seq/Final_Analyses/Cancer.v.Normal"</span>, <span class="dt">quants.path =</span> <span class="st">"./RNA_Seq/quants"</span>, </a>
<a class="sourceLine" id="cb10-3" title="3">          <span class="dt">samplesheet =</span> <span class="st">"./RNA_Seq/Samples.pairedCLL.txt"</span>, <span class="dt">tx2gene =</span> <span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>,</a>
<a class="sourceLine" id="cb10-4" title="4">          <span class="dt">level =</span> <span class="st">"status"</span>, <span class="dt">padj.thresh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), <span class="dt">plot.box =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb10-5" title="5">          <span class="dt">plot.annos =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"disease"</span>, <span class="st">"disease.sub"</span>, <span class="st">"status"</span>), <span class="dt">count.filt =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb10-6" title="6"></a>
<a class="sourceLine" id="cb10-7" title="7">paired.cll &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RunDESeq2.html">RunDESeq2</a></span>(<span class="dt">outpath =</span> <span class="st">"./RNA_Seq/Final_Analyses/pairedCLL"</span>, <span class="dt">quants.path =</span> <span class="st">"./RNA_Seq/quants"</span>, </a>
<a class="sourceLine" id="cb10-8" title="8">          <span class="dt">samplesheet =</span> <span class="st">"./RNA_Seq/Samples.pairedCLL.txt"</span>, <span class="dt">tx2gene =</span> <span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>,</a>
<a class="sourceLine" id="cb10-9" title="9">          <span class="dt">level =</span> <span class="st">"disease"</span>, <span class="dt">padj.thresh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), <span class="dt">plot.box =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-10" title="10">          <span class="dt">plot.annos =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"disease"</span>, <span class="st">"disease.sub"</span>, <span class="st">"status"</span>), <span class="dt">count.filt =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb10-11" title="11"></a>
<a class="sourceLine" id="cb10-12" title="12">can.v.norm.all &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RunDESeq2.html">RunDESeq2</a></span>(<span class="dt">outpath =</span> <span class="st">"./RNA_Seq/Final_Analyses/Cancer.v.Normal.AllCLL"</span>, <span class="dt">quants.path =</span> <span class="st">"./RNA_Seq/quants"</span>, </a>
<a class="sourceLine" id="cb10-13" title="13">          <span class="dt">samplesheet =</span> <span class="st">"./RNA_Seq/Samples.allCLL.txt"</span>, <span class="dt">tx2gene =</span> <span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>,</a>
<a class="sourceLine" id="cb10-14" title="14">          <span class="dt">level =</span> <span class="st">"status"</span>, <span class="dt">padj.thresh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), <span class="dt">plot.box =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb10-15" title="15">          <span class="dt">plot.annos =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"disease"</span>, <span class="st">"disease.sub"</span>, <span class="st">"status"</span>), <span class="dt">count.filt =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb10-16" title="16"></a>
<a class="sourceLine" id="cb10-17" title="17">all.cll &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RunDESeq2.html">RunDESeq2</a></span>(<span class="dt">outpath =</span> <span class="st">"./RNA_Seq/Final_Analyses/allCLL"</span>, <span class="dt">quants.path =</span> <span class="st">"./RNA_Seq/quants"</span>, </a>
<a class="sourceLine" id="cb10-18" title="18">          <span class="dt">samplesheet =</span> <span class="st">"./RNA_Seq/Samples.allCLL.txt"</span>, <span class="dt">tx2gene =</span> <span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>,</a>
<a class="sourceLine" id="cb10-19" title="19">          <span class="dt">level =</span> <span class="st">"disease"</span>, <span class="dt">padj.thresh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), <span class="dt">plot.box =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-20" title="20">          <span class="dt">plot.annos =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"disease"</span>, <span class="st">"disease.sub"</span>, <span class="st">"status"</span>), <span class="dt">count.filt =</span> <span class="dv">50</span>)</a>
<a class="sourceLine" id="cb10-21" title="21"></a>
<a class="sourceLine" id="cb10-22" title="22">can.v.norm.all.bl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RunDESeq2.html">RunDESeq2</a></span>(<span class="dt">outpath =</span> <span class="st">"./RNA_Seq/Final_Analyses/Cancer.v.Normal.AllCLL"</span>, <span class="dt">quants.path =</span> <span class="st">"./RNA_Seq/quants"</span>, </a>
<a class="sourceLine" id="cb10-23" title="23">          <span class="dt">samplesheet =</span> <span class="st">"./RNA_Seq/Samples.allCLL.txt"</span>, <span class="dt">tx2gene =</span> <span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>,</a>
<a class="sourceLine" id="cb10-24" title="24">          <span class="dt">level =</span> <span class="st">"status"</span>, <span class="dt">padj.thresh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), <span class="dt">plot.box =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb10-25" title="25">          <span class="dt">plot.annos =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"disease"</span>, <span class="st">"disease.sub"</span>, <span class="st">"status"</span>), <span class="dt">count.filt =</span> <span class="dv">50</span>, <span class="dt">block =</span> <span class="st">"lib"</span>)</a>
<a class="sourceLine" id="cb10-26" title="26"></a>
<a class="sourceLine" id="cb10-27" title="27">all.cll.bl &lt;-<span class="st"> </span><span class="kw"><a href="../reference/RunDESeq2.html">RunDESeq2</a></span>(<span class="dt">outpath =</span> <span class="st">"./RNA_Seq/Final_Analyses/allCLL"</span>, <span class="dt">quants.path =</span> <span class="st">"./RNA_Seq/quants"</span>, </a>
<a class="sourceLine" id="cb10-28" title="28">          <span class="dt">samplesheet =</span> <span class="st">"./RNA_Seq/Samples.allCLL.txt"</span>, <span class="dt">tx2gene =</span> <span class="st">"./RNA_Seq/ref/tx2gene.txt"</span>,</a>
<a class="sourceLine" id="cb10-29" title="29">          <span class="dt">level =</span> <span class="st">"disease"</span>, <span class="dt">padj.thresh =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.001</span>), <span class="dt">plot.box =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-30" title="30">          <span class="dt">plot.annos =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"disease"</span>, <span class="st">"disease.sub"</span>, <span class="st">"status"</span>), <span class="dt">count.filt =</span> <span class="dv">50</span>, <span class="dt">block =</span> <span class="st">"lib"</span>)</a></code></pre></div>
</div>
<div id="next-steps" class="section level3">
<h3 class="hasAnchor">
<a href="#next-steps" class="anchor"></a>Next Steps</h3>
<p>Yes, that’s it. Explore the plots, tables, enrichments, etc. Re-run if necessary, tweaking parameters as you see fit.</p>
</div>
</div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session Information</h1>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a></code></pre></div>
<pre><code>## R version 3.6.1 (2019-07-05)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 16299)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=English_United States.1252 
## [2] LC_CTYPE=English_United States.1252   
## [3] LC_MONETARY=English_United States.1252
## [4] LC_NUMERIC=C                          
## [5] LC_TIME=English_United States.1252    
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] OneLinerOmics_0.1.0.9000    DiffBind_2.14.0            
##  [3] SummarizedExperiment_1.16.0 DelayedArray_0.12.0        
##  [5] BiocParallel_1.20.0         matrixStats_0.55.0         
##  [7] Biobase_2.46.0              GenomicRanges_1.38.0       
##  [9] GenomeInfoDb_1.22.0         IRanges_2.20.0             
## [11] S4Vectors_0.24.0            BiocGenerics_0.32.0        
## [13] enrichR_2.1                 BiocStyle_2.14.0           
## 
## loaded via a namespace (and not attached):
##   [1] rsvd_1.0.2                               
##   [2] Hmisc_4.2-0                              
##   [3] ica_1.0-2                                
##   [4] Rsamtools_2.2.0                          
##   [5] lmtest_0.9-37                            
##   [6] rprojroot_1.3-2                          
##   [7] crayon_1.3.4                             
##   [8] MASS_7.3-51.4                            
##   [9] nlme_3.1-140                             
##  [10] backports_1.1.5                          
##  [11] GOSemSim_2.12.0                          
##  [12] rlang_0.4.1                              
##  [13] XVector_0.26.0                           
##  [14] ROCR_1.0-7                               
##  [15] ChIPQC_1.21.0                            
##  [16] irlba_2.3.3                              
##  [17] limma_3.42.0                             
##  [18] scater_1.14.1                            
##  [19] GOstats_2.52.0                           
##  [20] rjson_0.2.20                             
##  [21] chipseq_1.36.0                           
##  [22] bit64_0.9-7                              
##  [23] glue_1.3.1                               
##  [24] pheatmap_1.0.12                          
##  [25] sctransform_0.2.0                        
##  [26] vipor_0.4.5                              
##  [27] AnnotationDbi_1.48.0                     
##  [28] vsn_3.54.0                               
##  [29] base64url_1.4                            
##  [30] DOSE_3.12.0                              
##  [31] tidyselect_0.2.5                         
##  [32] fitdistrplus_1.0-14                      
##  [33] XML_3.98-1.20                            
##  [34] tidyr_1.0.0                              
##  [35] zoo_1.8-6                                
##  [36] GenomicAlignments_1.22.0                 
##  [37] xtable_1.8-4                             
##  [38] magrittr_1.5                             
##  [39] evaluate_0.14                            
##  [40] bibtex_0.4.2                             
##  [41] ggplot2_3.2.1                            
##  [42] Rdpack_0.11-0                            
##  [43] zlibbioc_1.32.0                          
##  [44] hwriter_1.3.2                            
##  [45] rstudioapi_0.10                          
##  [46] EZscRNA_0.1.0.9000                       
##  [47] EnhancedVolcano_1.4.0                    
##  [48] rpart_4.1-15                             
##  [49] fastmatch_1.1-0                          
##  [50] BiocSingular_1.2.0                       
##  [51] xfun_0.10                                
##  [52] askpass_1.1                              
##  [53] cluster_2.1.0                            
##  [54] caTools_1.17.1.2                         
##  [55] tidygraph_1.1.2                          
##  [56] tibble_2.1.3                             
##  [57] ggrepel_0.8.1                            
##  [58] ape_5.3                                  
##  [59] listenv_0.7.0                            
##  [60] Biostrings_2.54.0                        
##  [61] png_0.1-7                                
##  [62] future_1.14.0                            
##  [63] zeallot_0.1.0                            
##  [64] withr_2.1.2                              
##  [65] bitops_1.0-6                             
##  [66] ggforce_0.3.1                            
##  [67] RBGL_1.62.1                              
##  [68] plyr_1.8.4                               
##  [69] GSEABase_1.48.0                          
##  [70] pillar_1.4.2                             
##  [71] RcppParallel_4.4.4                       
##  [72] gplots_3.0.1.1                           
##  [73] GenomicFeatures_1.38.0                   
##  [74] TxDb.Dmelanogaster.UCSC.dm3.ensGene_3.2.2
##  [75] fs_1.3.1                                 
##  [76] europepmc_0.3                            
##  [77] DelayedMatrixStats_1.8.0                 
##  [78] vctrs_0.2.0                              
##  [79] urltools_1.7.3                           
##  [80] metap_1.1                                
##  [81] tools_3.6.1                              
##  [82] foreign_0.8-71                           
##  [83] beeswarm_0.2.3                           
##  [84] munsell_0.5.0                            
##  [85] tweenr_1.0.1                             
##  [86] fgsea_1.12.0                             
##  [87] compiler_3.6.1                           
##  [88] rtracklayer_1.46.0                       
##  [89] TxDb.Hsapiens.UCSC.hg19.knownGene_3.2.2  
##  [90] plotly_4.9.0                             
##  [91] GenomeInfoDbData_1.2.2                   
##  [92] gridExtra_2.3                            
##  [93] edgeR_3.28.0                             
##  [94] lattice_0.20-38                          
##  [95] AnnotationForge_1.28.0                   
##  [96] dplyr_0.8.3                              
##  [97] BiocFileCache_1.10.0                     
##  [98] jsonlite_1.6                             
##  [99] affy_1.64.0                              
## [100] scales_1.0.0                             
## [101] TxDb.Rnorvegicus.UCSC.rn4.ensGene_3.2.2  
## [102] graph_1.64.0                             
## [103] pbapply_1.4-2                            
## [104] genefilter_1.68.0                        
## [105] lazyeval_0.2.2                           
## [106] latticeExtra_0.6-28                      
## [107] R.utils_2.9.0                            
## [108] reticulate_1.13                          
## [109] TxDb.Mmusculus.UCSC.mm9.knownGene_3.2.2  
## [110] brew_1.0-6                               
## [111] checkmate_1.9.4                          
## [112] rmarkdown_1.16                           
## [113] pkgdown_1.4.1                            
## [114] cowplot_1.0.0                            
## [115] Rtsne_0.15                               
## [116] BSgenome_1.54.0                          
## [117] uwot_0.1.4                               
## [118] igraph_1.2.4.1                           
## [119] survival_2.44-1.1                        
## [120] yaml_2.2.0                               
## [121] plotrix_3.7-6                            
## [122] htmltools_0.4.0                          
## [123] memoise_1.1.0                            
## [124] VariantAnnotation_1.32.0                 
## [125] Seurat_3.1.1                             
## [126] locfit_1.5-9.1                           
## [127] graphlayouts_0.5.0                       
## [128] batchtools_0.9.11                        
## [129] viridisLite_0.3.0                        
## [130] digest_0.6.22                            
## [131] assertthat_0.2.1                         
## [132] rappdirs_0.3.1                           
## [133] npsurv_0.4-0                             
## [134] RSQLite_2.1.2                            
## [135] amap_0.8-17                              
## [136] future.apply_1.3.0                       
## [137] lsei_1.2-0                               
## [138] data.table_1.12.6                        
## [139] blob_1.2.0                               
## [140] R.oo_1.23.0                              
## [141] preprocessCore_1.48.0                    
## [142] splines_3.6.1                            
## [143] Formula_1.2-3                            
## [144] RCurl_1.95-4.12                          
## [145] hms_0.5.2                                
## [146] colorspace_1.4-1                         
## [147] base64enc_0.1-3                          
## [148] BiocManager_1.30.9                       
## [149] ggbeeswarm_0.6.0                         
## [150] SDMTools_1.1-221.1                       
## [151] nnet_7.3-12                              
## [152] tximport_1.14.0                          
## [153] Rcpp_1.0.2                               
## [154] bookdown_0.14                            
## [155] RANN_2.6.1                               
## [156] enrichplot_1.6.0                         
## [157] Nozzle.R1_1.1-1                          
## [158] ChIPseeker_1.22.0                        
## [159] R6_2.4.0                                 
## [160] grid_3.6.1                               
## [161] ggridges_0.5.1                           
## [162] lifecycle_0.1.0                          
## [163] acepack_1.4.1                            
## [164] ShortRead_1.44.0                         
## [165] curl_4.2                                 
## [166] TxDb.Hsapiens.UCSC.hg18.knownGene_3.2.2  
## [167] gdata_2.18.0                             
## [168] affyio_1.56.0                            
## [169] leiden_0.3.1                             
## [170] DO.db_2.9                                
## [171] Matrix_1.2-17                            
## [172] TxDb.Celegans.UCSC.ce6.ensGene_3.2.2     
## [173] qvalue_2.18.0                            
## [174] desc_1.2.0                               
## [175] RcppAnnoy_0.0.13                         
## [176] org.Hs.eg.db_3.10.0                      
## [177] RColorBrewer_1.1-2                       
## [178] stringr_1.4.0                            
## [179] htmlwidgets_1.5.1                        
## [180] polyclip_1.10-0                          
## [181] triebeard_0.3.0                          
## [182] biomaRt_2.42.0                           
## [183] purrr_0.3.3                              
## [184] gridGraphics_0.4-1                       
## [185] globals_0.12.4                           
## [186] openssl_1.4.1                            
## [187] htmlTable_1.13.2                         
## [188] codetools_0.2-16                         
## [189] GO.db_3.10.0                             
## [190] gtools_3.8.1                             
## [191] prettyunits_1.0.2                        
## [192] SingleCellExperiment_1.8.0               
## [193] dbplyr_1.4.2                             
## [194] R.methodsS3_1.7.1                        
## [195] gtable_0.3.0                             
## [196] tsne_0.1-3                               
## [197] DBI_1.0.0                                
## [198] httr_1.4.1                               
## [199] KernSmooth_2.23-15                       
## [200] stringi_1.4.3                            
## [201] progress_1.2.2                           
## [202] reshape2_1.4.3                           
## [203] farver_1.1.0                             
## [204] annotate_1.64.0                          
## [205] viridis_0.5.1                            
## [206] Rgraphviz_2.30.0                         
## [207] xml2_1.2.2                               
## [208] rvcheck_0.1.6                            
## [209] systemPipeR_1.20.0                       
## [210] boot_1.3-22                              
## [211] BiocNeighbors_1.4.1                      
## [212] geneplotter_1.64.0                       
## [213] ggplotify_0.0.4                          
## [214] Category_2.52.0                          
## [215] DESeq2_1.26.0                            
## [216] bit_1.1-14                               
## [217] TxDb.Mmusculus.UCSC.mm10.knownGene_3.10.0
## [218] ggraph_2.0.0                             
## [219] pkgconfig_2.0.3                          
## [220] gbRd_0.4-11                              
## [221] knitr_1.25</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#suggested-reading">Suggested Reading</a><ul class="nav nav-pills nav-stacked">
<li><a href="#generating-gene-counts">Generating gene counts</a></li>
      <li><a href="#analysis-with-r">Analysis with R</a></li>
      </ul>
</li>
      <li><a href="#session-information">Session Information</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="http://j-andrews7.github.io">Jared Andrews</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
